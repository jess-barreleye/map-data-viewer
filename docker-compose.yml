services:
  tileserver:
    build: .
    container_name: maplibre-tileserver
    ports:
      - "8080:8080"
    # Mount local maps directory into the container under /data/mbtiles
    # so we do not override the container's /data directory. New .mbtiles
    # files can be added to ./maps and will be visible at /data/mbtiles.
    # Also mount the explicit config.json into /data/config.json.
    volumes:
      - ./maps:/data/mbtiles:ro
      - ./tileserver-config.json:/data/config.json:ro
    environment:
      - TILESERVER_GL_LOG_LEVEL=info
    restart: unless-stopped

  gps-server:
    build: ./gps-server
    container_name: maplibre-gps-server
    ports:
      - "12345:12345/udp"  # UDP port for Seapath GPS data input
      - "8081:8081"         # WebSocket port for browser clients
    environment:
      - UDP_PORT=12345
      - UDP_HOST=0.0.0.0
      - WS_PORT=8081
    restart: unless-stopped
